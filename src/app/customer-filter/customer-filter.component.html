<section class="customer-filter">
  <header class="filter-header">
    <div class="header-text">
      <h1>Customer filter</h1>
      <p>Select events and attributes to build your funnel.</p>
    </div>
    <div class="header-actions">
      <button mat-button type="button" (click)="discardFilters()" [disabled]="!canDiscard()">
        Discard filters
      </button>
      <button mat-flat-button color="primary" type="button" (click)="applyFilters()">
        Apply filters
      </button>
    </div>
  </header>

  <section class="steps">
    <ng-container *ngIf="steps() as stepList">
      <app-filter-step
        *ngFor="let step of stepList; index as index; trackBy: trackStep"
        [step]="step"
        [stepIndex]="index"
        [events]="events()"
        [isOnlyStep]="stepList.length === 1"
        (eventSelect)="onEventSelect($event)"
        (addAttribute)="addAttribute($event)"
        (attributePropertyChange)="onAttributePropertyChange($event)"
        (attributeOperatorChange)="onAttributeOperatorChange($event)"
        (attributeValueChange)="onAttributeValueChange($event)"
        (removeAttribute)="removeAttribute($event)"
        (duplicate)="duplicateStep($event)"
        (remove)="removeStep($event)"
      ></app-filter-step>
    </ng-container>
  </section>

  <button mat-stroked-button type="button" class="add-step" (click)="addStep()">
    <mat-icon>add</mat-icon>
    Add funnel step
  </button>

  <p class="loading" *ngIf="loading()">Loading eventsâ€¦</p>
</section>
